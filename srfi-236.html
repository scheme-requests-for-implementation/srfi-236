<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>SRFI 236: Evaluating Scheme expressions in an unspecified order</title>
    <link href="/favicon.png" rel="icon" sizes="192x192" type="image/png">
    <link rel="stylesheet" href="https://srfi.schemers.org/srfi.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1"></head>
  <body>
    <h1><a href="https://srfi.schemers.org/"><img class="srfi-logo" src="https://srfi.schemers.org/srfi-logo.svg" alt="SRFI surfboard logo" /></a>236: Evaluating Scheme expressions in an unspecified order</h1>

    <p>by Marc Nieper-Wi&szlig;kirchen</p>

    <h2 id="status">Status</h2>

    <p style="color: red;">For editor's use only.  Please do not edit this section.</p>

    <p>??? the draft/final/withdrawn status of the SRFI, information on how
      to subscribe to its mailing list, and important dates in its history.
      The editor will add this section.</p>

    <h2 id="abstract">Abstract</h2>

    <p>This SRFI defines the <code>perform</code> syntax, which can be
    used to combine side effects into one expression without
    specifying their relative order.</p>

    <h2 id="rationale">Rationale</h2>

    <p>The purpose of the <code>begin</code> expression type in the
      existing Scheme standards is two-fold.  Firstly, it can be used to
      combine several expressions into one expression.  Secondly, it is
      used to sequence the side effects of these expressions by
      specifying an evaluation order.</p>

    <p>In many use cases, only the first property is needed while any
      specific sequence order would be arbitrary.  Thus, many Scheme
      programs written with <code>begin</code> overspecify the
      underlying algorithm.  As Scheme is a language to write down
      algorithms as much as it is a practical programming language,
      this SRFI introduces the <code>perform</code> syntax, which is
      similar to <code>begin</code> but without any specific
      evaluation order (and thus no return value(s)).</p>

    <p>The practical side of the <code>perform</code> syntax is that
      it allows a compiler to reorder expressions freely and that it
      helps documenting code.  If expressions appear inside
      a <code>perform</code> form, the programmer expresses the fact
      that the relative order of these expressions does not matter.
      This can make imperatively-written programs easier to
      understand.</p>

    <p>As the result of a <code>perform</code> expression is
      unspecified, a perform expression, contrary to
      a <code>begin</code> expression, need not contain any
      expression.  This can make a <code>perform</code> expression
      useful for macro writers.</p>

    <h2 id="specification">Specification</h2>

    <h3>Example</h3>

    <p>The following procedure could have been written
      with <code>begin</code> instead of <code>perform</code> but it
      would have been an overspecification of the underlying
      algorithmic content.</p>

    <pre>(define set-car+cdr!
  (lambda (p x y)
    (assert (pair? p))
    (perform
      (set-car! p x)
      (set-cdr! p y))))</pre>

    <h3>Syntax</h3>

    <p><code>(perform &langle;expression&rangle; &hellip;)</code></p>

    <p>Evaluates the &langle;expressions&rangle;s in an unspecified
      order and discards their return values.  The result of
      the <code>perform</code> expression is unspecified.</p>

    <h3>Library name</h3>

    <p>The SRFI 97-conformant library name of this SRFI is <code>(srfi
    :236 perform)</code>.</p>

    <h2 id="implementation">Implementation</h2>

    <p>The following is an R<sup>6</sup>RS implementation.</p>

    <pre>(library (srfi :236 perform)
  (export perform)
  (import (rnrs))
  (define-syntax perform
    (lambda (stx)
      (syntax-case stx ()
        [(_ expr ...)
         (with-syntax ([(tmp ...) (generate-temporaries #'(expr ...))])
           #'(let-values ([tmp expr] ...) (values)))]
        [_ (syntax-violation 'perform "invalid syntax" stx)]))))</pre>

    <p>An R<sup>7</sup>RS (small) implementation is also possible.</p>

    <h2 id="acknowledgements">Acknowledgements</h2>

    <p>Thanks go to the members of the Scheme Working Group 2 for
      discussing the idea of the <code>perform</code> expression with
      me.  The name <code>perform</code> was suggested by Daphne
      Preston-Kendal.</p>

    <h2 id="copyright">Copyright</h2>
    <p>&copy; 2022  Marc Nieper-Wi&szlig;kirchen.</p>

    <p>
      Permission is hereby granted, free of charge, to any person
      obtaining a copy of this software and associated documentation files
      (the "Software"), to deal in the Software without restriction,
      including without limitation the rights to use, copy, modify, merge,
      publish, distribute, sublicense, and/or sell copies of the Software,
      and to permit persons to whom the Software is furnished to do so,
      subject to the following conditions:</p>

    <p>
      The above copyright notice and this permission notice (including the
      next paragraph) shall be included in all copies or substantial
      portions of the Software.</p>
    <p>
      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
      EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
      MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
      NONINFRINGEMENT.  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
      BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
      ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
      CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
      SOFTWARE.</p>

    <hr>
    <address>Editor: <a href="mailto:srfi-editors+at+srfi+dot+schemers+dot+org">Arthur A. Gleckler</a></address></body></html>
